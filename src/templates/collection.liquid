{% if request.path == '/collections/all' or request.path == '/collections/types'
%}{% assign all = true %}{% endif %} {% if request.path == '/collections/types'
%} {% assign filtered = true %} {% endif %}
<div
  id="collection-splash"
  {%
  if
  all
  %}class="bg-teal"
  style="background-image: url({{
    settings.teal_texture | img_url: 'master'
  }});"
  {%
  else
  %}
  style="background-image: url('{{ collection.image | img_url: 'master' }}');"
  {%
  endif
  %}
>
  <div class="title white">
    <h1>
      {% if filtered %}All Collections / {% endif %}{{ collection.title }}
    </h1>
  </div>
</div>

<div id="collection" class="medium-down--pt-3 medium-down--pb-2 pt-4 pb-2">
  {% if all %}
  <div class="grid mb-3">
    <div class="grid__item">
      <ul id="product-type-list" class="small">
        {% for product_type in shop.types %} {% if product_type == blank %}{%
        continue %}{% endif %} {% assign typeLink = "/collections/types?q=" |
        append: product_type | downcase | replace: ' ', '+' %} {% assign url =
        canonical_url | downcase %}

        <li data-filter="{{ product_type }}">
          <a
            href="{{ typeLink }}"
            {%
            if
            url
            contains
            typeLink
            %}
            class="active"
            {%
            endif
            %}
            >{{ product_type }}</a
          >
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
  {% endif %}
  <div class="grid">
    {% paginate collection.products by 20 %} {% for product in
    collection.products %}
    <div
      class="grid__item  medium--one-half large-up--one-third  widescreen--one-quarter small--mb-2 mb-3 {% if product.available %}available{% else %}soldout{% endif %}"
    >
      {% if product.featured_image != blank %}
      <a href="{{ product.url | within: collection }}">
        <!--
        {% include 'responsive-image' with image: product.featured_image,
        max_width: 1400, max_height: 1600 %}
-->

        <div class="product-container">
          <img src="{{ product.featured_image | img_url: 'master' }}" alt="" />
        </div>
      </a>
      {% endif %}

      <p class="mt-1">
        <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
      </p>
      <p>
        <b>{{ product.price | money }}</b>
      </p>
    </div>
    {% endfor %}
  </div>
  <div class="mb-4">
    {% if paginate.pages > 1 %} {% include 'pagination' %} {% endif %} {%
    endpaginate %}
  </div>
</div>

<script>
  // Set padding-right on collection to = sidebar
  // save original padding

  $(window).on("load resize", function() {
    var windowWidth = $(window).width();

    if (windowWidth > 1800) {
      var sidebarWidth = $("#side").innerWidth();
      $("#collection").css("padding-left", sidebarWidth);
      $("#collection").css("padding-right", sidebarWidth);
    } else {
      $("#collection").css("padding-left", "4vw");
      $("#collection").css("padding-right", "4vw");
    }
  });
</script>
